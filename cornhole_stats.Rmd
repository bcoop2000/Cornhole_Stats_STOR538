---
title: "Cornhole_2021_stats"
author: "Brian"
date: "2023-02-26"
output: html_document
---

```{r}
library(readr)
library(tidyverse)
```


```{r}
# data <- read.csv("STOR 538_ P1 - Sheet1.csv", header=TRUE, skip=1)
# data$Match. <- as.factor(data$Match.)
# data$Round. <- as.factor(data$Round.)
# data$Throw_Number <- as.factor(data$Throw_Number)
# data$Bag. <- as.factor(data$Bag.)


# data_cleaned <- data%>%
# filter(Round. != "FINAL")
```

# Data Configuration

```{r}
## Pull data in
Master <- read.csv("master.csv", header=TRUE, skip=1)
Game_scores <- read.csv("Game_scores.csv", header=TRUE)
Round_scores <- read.csv("Round_scores.csv", header=TRUE)

Master$Match <- as.factor(Master$Match)
Master$Round <- as.factor(Master$Round)
Master$Throw_Number <- as.factor(Master$Throw_Number)
Master$Bag_Number <- as.factor(Master$Bag_Number)
```

```{r}
## merge data

Cornhole <- merge(Master, Round_scores, by.x = c("Match", "Round"), by.y = c("Game_Number", "Round_Number"))
Cornhole <- merge(Cornhole, Game_scores, by.x = "Match", by.y = "Game_Number")
Cornhole <- Cornhole%>%
  select(-c("Player_1.y", "Player_2.y"))
```


## Data Preview

```{r}
head(Master)
```

## Variable Breakdown by Throws

```{r}
Throw_breakdown <- Master%>%
  group_by(Throw_Number)%>%
  summarise(total = n(),
            in_hole_pct = round(sum(In_Hole)/total*100,1),
            on_board_pct = round(sum(On_Board)/total*100,1),
            missed_board_pct = round(sum(Missed_Board)/total*100,1),
            avg_Own_bags_dragged = sum(Own_Other_Bags_Dragged_In)/total,
            avg_Opponent_Bags_Dragged_In = sum(Opponent_Bags_Dragged_In)/total,
            avg_Own_Other_Bags_Knocked_Off = sum(Own_Other_Bags_Knocked_Off)/total,
            avg_Opponent_Other_Bags_Knocked_Off = sum(Opponent_Other_Bags_Knocked_Off)/total,
            Hole_Blocked_Before_Throw_pct = round(sum(as.numeric(Hole_Blocked_Before_Throw))/total*100,1),
            Hole_Blocked_After_pct = round(sum(Hole_Blocked_After_Throw)/total*100,1))

Throw_breakdown
```

## Visualizing a Round

```{r}
in_hole_by_throw_plot <- plot(Throw_breakdown$Throw_Number, Throw_breakdown$in_hole_pct, xlab = "Throw", ylab = "in hole percentage")
in_hole_by_throw_plot
```

```{r}
blocked_by_throw_plot <- plot(Throw_breakdown$Throw_Number, Throw_breakdown$Hole_Blocked_Before_Throw_pct, xlab = "Throw", ylab = "Hole Blocked For Throw")
blocked_by_throw_plot
```

# Analysis with Metrics


## Throw Skill

### Average Toss Score (ATS)

```{r}
## Average Toss Score (ATS)
```

## Board Management

### Cluttering

#### Blocks Created (BC)

```{r}

```

#### Adjusted Blocks Created (ABC)

```{r}

```


### Cleaning

#### Board Impact (BI)

```{r}

```

#### Net Board Score (NBS)

```{r}

```



